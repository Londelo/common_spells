# fan-identity-workers

**Repository Documentation** - Generated by TM Repository Documentation System

---

## Metadata

| Property | Value |
|----------|-------|
| **Generated** | 2026-02-16 |
| **Source Repository** | `/Users/Brodie.Balser/Documents/TM/vf/fan-identity/workers` |
| **Classification** | worker |
| **Agent Status** | 8/8 succeeded |

---

## Overview

The **fan-identity-workers** repository contains AWS Lambda workers for the VerifiedFan platform's identity and fraud prevention systems. It provides real-time risk scoring, identity verification, bot detection, and authentication services to protect the ticketing platform from fraudulent activity.

**What This System Does:**
- **Real-Time Risk Scoring** - Processes user activities (logins, purchases, registrations) through ML models to calculate fraud risk scores in 2-5 seconds
- **Identity Verification** - Integrates with Persona to perform liveness checks via 15-60 second selfie video analysis
- **Bot Detection** - Imports and processes bot detection data from ML models
- **Authentication Services** - Provides AppSync GraphQL API authorization with JWT token validation
- **Scheduled Rescoring** - Orchestrates delayed fraud score recalculation using 5-day TTL debounce periods

**Business Context:**
- Protects Ticketmaster's VerifiedFan ticket sales from fraud rings, bots, and account takeovers
- Processes 1000+ user activities per second during high-demand events
- Maintains 5-minute score freshness for real-time fraud decisions
- Supports identity verification for high-risk users to build trust

**Target Consumers:**
- VerifiedFan Registration Service (risk score consumers)
- Campaign Management (verification requirement decisions)
- Customer Support (manual rescore triggers)
- Data Science Team (ML model integration)

---

## Core Documentation

### Purpose & Business

| Document | Description |
|----------|-------------|
| [purpose-overview.md](dynamic/purpose-overview.md) | What the system does, why it exists, business context, requirements, integration points |
| [purpose-usecases.md](dynamic/purpose-usecases.md) | Primary use cases, user journeys, workflows, real-world scenarios |
| [purpose-domain.md](dynamic/purpose-domain.md) | Core entities, business rules, terminology, data models, domain relationships |

### Architecture & Structure

| Document | Description |
|----------|-------------|
| [architecture-structure.md](static/architecture-structure.md) | Directory layout, key directories, entry points, file organization patterns |
| [architecture-patterns.md](static/architecture-patterns.md) | Architecture style (Serverless + Event-Driven), design patterns, layer separation |
| [architecture-dataflow.md](static/architecture-dataflow.md) | Data flow through workers, event processing, external integrations |

### Dependencies

| Document | Description |
|----------|-------------|
| [dependencies-external.md](dynamic/dependencies-external.md) | External npm packages (14 production, 47 dev dependencies) |
| [dependencies-internal.md](dynamic/dependencies-internal.md) | Internal @verifiedfan/* packages (15 packages), coupling analysis |
| [dependencies-analysis.md](dynamic/dependencies-analysis.md) | Risk assessment, outdated packages, security considerations, recommendations |

---

## Technical Documentation

### API & Contracts

| Document | Description |
|----------|-------------|
| [api-contracts.md](dynamic/api-contracts.md) | AppSync GraphQL resolvers (5), event-driven workers (11), shared types |
| [api-usage.md](dynamic/api-usage.md) | Authentication patterns, GraphQL examples, event payloads, testing guides |

### Type Definitions

| Document | Description |
|----------|-------------|
| [types-definitions.md](dynamic/types-definitions.md) | 50+ explicit types (Worker, Identity, Scoring, Service, Config types) |
| [types-usage.md](dynamic/types-usage.md) | 30+ function signatures, validation schemas, patterns, call graphs |

### Infrastructure

| Document | Description |
|----------|-------------|
| [infrastructure-resources.md](static/infrastructure-resources.md) | AWS resources (14 Lambdas, DynamoDB, SQS, Kinesis, Redis, API Gateway) |
| [infrastructure-deployment.md](static/infrastructure-deployment.md) | GitLab CI pipeline, Terraform deployment, 4 environments, testing stages |
| [infrastructure-operations.md](static/infrastructure-operations.md) | Monitoring, alerting, 7 operational runbooks, debugging procedures |

### Testing & Quality

| Document | Description |
|----------|-------------|
| [testing-strategy.md](static/testing-strategy.md) | Test organization (70 files), frameworks (Jest, Cucumber), CI configuration |
| [testing-coverage.md](static/testing-coverage.md) | Coverage by domain, well-tested areas, testing gaps, recommendations |

### Code Style & Standards

| Document | Description |
|----------|-------------|
| [style-conventions.md](dynamic/style-conventions.md) | Naming conventions, formatting rules, ESLint config, engineering principles |
| [style-complexity.md](dynamic/style-complexity.md) | Complexity metrics, simple vs complex areas, recommendations |

---

## Agent Status

| Agent | Status | Files Generated | Notes |
|-------|--------|-----------------|-------|
| **Architecture** | âœ… Success | 3 | Serverless + Event-Driven, 5 deployment stacks |
| **Dependencies** | âœ… Success | 3 | 14 production, 47 dev, 15 internal packages |
| **Infrastructure** | âœ… Success | 3 | 14 Lambdas, Terraform IaC, GitLab CI |
| **API** | âœ… Success | 2 | 5 GraphQL resolvers, 11 event workers |
| **Purpose** | âœ… Success | 3 | Fraud prevention, identity verification, real-time scoring |
| **Testing** | âœ… Success | 2 | 70 test files, Jest + Cucumber, integration tests |
| **Coding Style** | âœ… Success | 2 | Functional programming, strict ESLint, avg 25 lines/fn |
| **Types** | âœ… Success | 2 | 50+ explicit types, 30+ function signatures |

**Total Documentation Files Generated:** 20

---

## Quick Start

### Understanding the System

1. **New to the codebase?** Start with [purpose-overview.md](dynamic/purpose-overview.md) to understand what this does and why
2. **Need to understand the architecture?** Read [architecture-structure.md](static/architecture-structure.md) and [architecture-dataflow.md](static/architecture-dataflow.md)
3. **Working on identity verification?** See [purpose-usecases.md](dynamic/purpose-usecases.md) for the liveness flow
4. **Need to deploy?** Check [infrastructure-deployment.md](static/infrastructure-deployment.md) for GitLab CI pipeline details
5. **Looking for types?** Browse [types-definitions.md](dynamic/types-definitions.md) for all type contracts

### Common Questions

**Q: What events does this system process?**
- See [api-contracts.md](dynamic/api-contracts.md) for all 11 event-driven workers

**Q: How does risk scoring work?**
- See [purpose-usecases.md](dynamic/purpose-usecases.md) Use Case 1: Real-Time Risk Scoring

**Q: What AWS resources does this use?**
- See [infrastructure-resources.md](static/infrastructure-resources.md) for complete inventory

**Q: How do I run tests?**
- See [testing-strategy.md](static/testing-strategy.md) for test commands and organization

**Q: What's the coding style?**
- See [style-conventions.md](dynamic/style-conventions.md) for naming, formatting, and principles

---

## Key Highlights

### Architecture
- **15 AWS Lambda workers** organized into 5 deployment stacks (auth, botornot, clustering, idv, scoring)
- **Event-Driven Architecture** with Kinesis, Kafka, SQS, DynamoDB streams
- **Multi-region deployment** (east/west) for scoring workloads
- **Terraform IaC** with GitLab CI/CD pipeline

### Business Impact
- Processes **1000+ activities/second** during high-demand events
- **2-5 second** fraud score calculation latency
- **5-minute** score freshness for real-time decisions
- **5-day** rescore debounce to avoid score staleness
- **15-60 second** identity verification via liveness checks

### Technology Stack
- **Languages:** TypeScript (primary), JavaScript (legacy)
- **AWS Services:** Lambda, AppSync, DynamoDB, Kinesis, SQS, S3, API Gateway, Redis
- **External Services:** Persona (IDV), Ticketmaster Accounts, Databricks, ARM Redis, Kafka
- **Frameworks:** Serverless Framework, Terraform, Jest, Cucumber
- **Patterns:** Functional programming, middleware composition, factory pattern, pure functions

### Code Quality
- **Functional Programming** - Strict immutability, no classes, pure functions
- **Small Functions** - Average 25 lines, max complexity 6
- **Strong Type Safety** - 50+ TypeScript types, strict compiler settings
- **Comprehensive Testing** - 70 test files covering unit, integration, feature tests
- **Consistent Style** - Enforced by ESLint with 50+ rules

---

## Next Steps

### For AI Assistants

When answering questions about this repository:
1. **Always cite specific documentation files** - Link to the relevant .md file and section
2. **Cross-reference related docs** - Connect architecture, types, and purpose docs
3. **Quote actual code examples** - Use examples from types-usage.md and api-contracts.md
4. **Reference business rules** - Cite rules from purpose-domain.md when explaining behavior
5. **Check multiple sources** - Architecture, API, and purpose docs often complement each other

### For Developers

1. **Keep docs in sync** - Update dynamic docs when making significant changes
2. **Refresh static docs quarterly** - Architecture and infrastructure change slowly
3. **Use types-definitions.md** - As authoritative source for all type contracts
4. **Consult operational runbooks** - infrastructure-operations.md has debugging procedures
5. **Follow coding conventions** - style-conventions.md documents team standards

---

## Documentation Maintenance

### Static Documentation (Changes Rarely)

Located in `static/` - Update when:
- Architecture changes significantly
- New AWS resources added
- Testing strategy changes
- Infrastructure patterns evolve

**Files:** architecture-*.md, infrastructure-*.md, testing-*.md

### Dynamic Documentation (Changes Frequently)

Located in `dynamic/` - Update when:
- New APIs/workers added
- Dependencies upgraded
- Types or interfaces change
- Business rules evolve
- Code style conventions change

**Files:** dependencies-*.md, api-*.md, types-*.md, purpose-*.md, style-*.md

### Regeneration

To regenerate all documentation:
```bash
/document-repos /path/to/fan-identity-workers
```

---

**ðŸ’¡ Generated by [TM Repository Documentation System](https://git.tmaws.io/ai/vf-marketplace)**
**ðŸ“… Last Generated:** 2026-02-16
**ðŸ¤– Agent Version:** 1.0.0
